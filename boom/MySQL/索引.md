## 索引原理

### B 树
B 树是多路平衡查找树，每一个节点最多包含 m 个孩子，m 被称为 B 树的阶，其大小取决于磁盘页的大小。一个 m 阶的 B 树具有如下几个特征：
1. 根结点至少有两个子节点
2. 每个中间节点都包含k-1个元素和k个孩子，其中 m/2 <= k <= m
3. 每一个叶子节点都包含k-1个元素，其中 m/2 <= k <= m
4. 所有的叶子结点都位于同一层
5. 每个节点中的元素从小到大排列，节点当中 k-1 个元素正好是 k 个孩子包含的元素的值域分划

### B+ 树
一个 m 阶的 B+ 树具有如下几个特征：
1. 有 k 个子树的中间节点包含有 k 个元素（B 树中是 k-1 个元素），每个元素不保存数据，只用来索引，所有数据都保存在叶子节点
2. 所有的叶子结点中包含了全部元素的信息，及指向含这些元素记录的指针，且叶子结点本身依关键字的大小自小而大顺序链接
3. 所有的中间节点元素都同时存在于子节点，在子节点元素中是最大（或最小）元素

### B 树 VS B+ 树
1. B 树中每个节点包含了键值和键值对应的数据对象存放地址，所以成功搜索一个对象可以不用到达树的叶节点；B+ 树非叶节点中并不存放数据对象的地址，非叶节点只是索引部分。所有的叶节点在同一层上，包含了全部键值和相应数据对象的存放地址，且叶节点按键值从小到大顺序链接
2. B 树中同一键值不会出现多次，B+ 树的键一定会出现在叶结点中，并且有可能在非叶结点中也有可能重复出现，以维持 B+ 树的平衡
3. B 树的键位置不定，且在整个树结构中只出现一次，虽然可以节省存储空间，但插入、删除操作复杂度明显增加。B+ 树相比来说是一种较好的折中
4. B 树的查询效率与键在树中的位置有关，最大时间复杂度与 B+ 树相同，最小时间复杂度为 1；B+ 树的时候复杂度对某建成的树是固定的
5. B+ 树有 2 个头指针，一个是树的根节点，一个是最小键值的叶节点。所以 B+ 树有两种搜索方法：一种是按叶节点自己拉起的链表顺序搜索，一种是从根节点开始搜索
6. B+ 树相比 B 树中间节点没有数据，所以同样大小的磁盘页可以容纳更多的节点元素

## B+ 树索引 VS 哈希索引
1. 如果是等值查询，哈希索引具有优势，因为只需要一次算法即可找到相应的键值
2. 如果是范围查询检索，有序的键值经过哈希算法后，可能变得不连续，就没办法再利用索引完成范围查询检索
3. 哈希索引没办法利用索引完成排序，以及 `like 'xxx%'` 这样的模糊查询
4. 哈希索引不支持多列联合索引的最左匹配规则
5. 在有大量重复键值情况下，哈希索引的效率极低

## 索引缺点
1. 增加了数据库的存储空间
2. 在插入和修改数据时要花费较多的时间

## 索引优点
1. 加快数据库的检索速度